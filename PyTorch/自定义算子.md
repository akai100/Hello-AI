PyTorch 提供了大量可对张量进行操作的运算符（例如 ```torch.add```、```torch.sum``` 等）。不过，你可能希望为 PyTorch 引入新的自定义操作，
并使其能与 ```torch.compile```、自动求导以及 ```torch.vmap``` 等子系统协同工作。要实现这一点，你必须通过 Python 的 torch.library 文档 
或 C++ 的 TORCH_LIBRARY API 向 PyTorch 注册该自定义操作

# 1. 用Python编写自定义运算符

如果出现以下情况，你可能希望通过Python（而非C++）编写自定义算子：

+ 你有一个Python函数，希望PyTorch将其视为一个不透明的可调用对象，尤其是在torch.compile和torch.export方面;

      1.核心诉求：函数对 PyTorch “不透明”——PyTorch 无需理解函数内部逻辑，仅需将其当作一个独立、可调用的操作单元；
      2.关键适配场景：
      (1)torch.compile：PyTorch 的编译优化工具，需自定义算子能被编译且不破坏优化逻辑；
      (2)torch.export：模型导出工具，需自定义算子能被正确序列化，支持跨环境部署；
      3.适用方式：需通过 PyTorch 提供的 torch.library API 注册该 Python 函数，使其成为官方认可的自定义算子，而非普通 Python 函数（普通函数无法兼容上述子系统）

+ 你有一些到C++/CUDA内核的Python绑定，并希望这些绑定能与PyTorch子系统（如```torch.compile```或```torch.autograd```）组合使用。
