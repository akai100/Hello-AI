# 1. 保存和加载模型权重

PyTorch模型将学到的参数存储在一个内部状态字典中，该字典称为```state_dict```。这些参数可以通过```torch.save```方法进行持久化存储：

```python3
model = models.vgg16(weights='IMAGENET1K_V1')
torch.save(model.state_dict(), 'model_weights.pth')
```

要加载模型权重，你需要先创建一个相同模型的实例，然后使用load_state_dict()方法加载参数

在下面的代码中，我们将weights_only=True设置为仅限制反序列化期间执行的函数，只保留加载权重所必需的函数。加载权重时，使用weights_only=True被视为一种最佳实践。

```python3
model = models.vgg16() # we do not specify ``weights``, i.e. create untrained model
model.load_state_dict(torch.load('model_weights.pth', weights_only=True))
model.eval()
```

# 2. 带形状的模型保存与加载

加载模型权重时，我们需要先实例化模型类，因为该类定义了网络的结构。我们可能希望将这个类的结构与模型一起保存，在这种情况下，我们可以将model（而不是```model.state_dict()```）传递给保存函数：

```python3
torch.save(model, 'model.pth')
```
正如在保存和加载```torch.nn.Modules```中所描述的，保存```state_dict``被认为是最佳实践。然而，下面我们使用```weights_only=False```，因为这涉及到加载模型，这是```torch.save```的一个遗留用例。
```python3
model = torch.load('model.pth', weights_only=False)
```
