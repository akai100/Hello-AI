
运行时在cudart库中实现，该库以静态方式（通过cudart.lib或libcudart.a）或动态方式（通过cudart.dll或libcudart.so）链接到应用程序。

需要cudart.dll或cudart.so进行动态链接的应用程序通常会将它们作为应用程序安装包的一部分。只有在链接到同一CUDA运行时实例的组件之间传递CUDA运行时符号的地址才是安全的。


其所有入口点都以cuda为前缀。

# 1. 初始化

从CUDA 12.0开始，```cudaInitDevice()```和```cudaSetDevice()```调用会初始化运行时以及与指定设备相关联的主上下文。

如果没有这些调用，运行时将隐式使用设备0，并在需要处理其他运行时API请求时自行初始化。

运行时会为系统中的每个设备创建一个CUDA上下文。此上下文是该设备的主上下文，并在第一个需要该设备上有活动上下文的运行时函数中初始化。它在应用程序的所有主机线程之间共享。作为此上下文创建的一部分，如有必要，设备代码会进行即时编译（参见即时编译）并加载到设备内存中。

当主机线程调用cudaDeviceReset()时，这会销毁该主机线程当前操作的设备的主上下文（即设备选择中定义的当前设备）。任何将该设备作为当前设备的主机线程进行的下一次运行时函数调用，都将为该设备创建一个新的主上下文。

# 2. 设备内存

如异构编程中所述，CUDA编程模型假定系统由主机和设备组成，两者各有独立的内存。核函数在设备内存中运行，因此运行时提供了用于分配、释放和复制设备内存以及在主机内存和设备内存之间传输数据的函数。

设备内存既可以分配为线性内存，也可以分配为CUDA数组。

CUDA数组是为纹理获取优化的不透明内存布局。

线性内存分配在一个单一的统一地址空间中，这意味着单独分配的实体可以通过指针相互引用，例如在二叉树或链表中。

线性内存通常使```cudaMalloc()```分配，使用```cudaFree()```释放，而主机内存和设备内存之间的数据传输通常通过```cudaMemcpy()```完成。

